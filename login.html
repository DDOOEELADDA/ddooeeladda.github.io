<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¡œê·¸ì¸</title>
  <link rel="stylesheet" href="style.css">
</head>

<body class="bg">

<header class="nav">
  <div class="nav-inner">
    <a href="index.html" class="logo">Hog Boxing</a>
    <nav class="menu">
      <a href="index.html">í™ˆ</a>
      <a href="ranking.html">ë­í‚¹</a>
      <a href="board.html">ê²Œì‹œíŒ</a>

      <!-- ë¡œê·¸ì¸ ì „ -->
      <a href="login.html" id="loginMenu">ë¡œê·¸ì¸</a>

      <!-- ë¡œê·¸ì¸ í›„ -->
      <span id="userMenu" style="display:none;">
      <span id="userName" style="margin-left:15px; margin-right:1px;"></span>
        <a href="#" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</a>
      </span>
    </nav>
  </div>
</header>

<div class="page-container" style="max-width:500px;">
  <h1 class="page-title">ë¡œê·¸ì¸</h1>

  <input class="input" id="email" placeholder="ì´ë©”ì¼">
  <input class="input" id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">

  <button class="btn-primary" id="loginBtn">ë¡œê·¸ì¸</button>

  <p style="margin-top:15px;">
    ì•„ì§ íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”?
    <a href="signup.html">íšŒì›ê°€ì…</a>
  </p>

  <hr style="border-color:#333; margin:25px 0;">

  <button class="btn-outline" id="googleLogin">Googleë¡œ ë¡œê·¸ì¸</button>
</div>

<!-- Firebase v8 (í†µì¼) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  
<script src="firebase.js"></script>

<script>
  /* ===============================
      ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì ‘ê·¼ ì°¨ë‹¨
  =============================== */
  auth.onAuthStateChanged(user => {
    const loginMenu = document.getElementById("loginMenu");
    const userMenu = document.getElementById("userMenu");
    const userName = document.getElementById("userName");

    if (user) {
      // ìƒë‹¨ ë©”ë‰´ í‘œì‹œ
      loginMenu.style.display = "none";
      userMenu.style.display = "inline";
      const name = user.displayName || user.email;
      userName.textContent = `[${name}]`;

      // ğŸ”¥ ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ì°¨ë‹¨
      alert("ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœì…ë‹ˆë‹¤.");
      location.replace("index.html");
      return;
    }

    // ë¡œê·¸ì¸ ì•ˆ ëœ ìƒíƒœ
    loginMenu.style.display = "inline";
    userMenu.style.display = "none";
  });
</script>

  <script>
  // âœ… ì´ë©”ì¼ ë¡œê·¸ì¸
  document.getElementById("loginBtn").onclick = function () {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password) {
      alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    auth.signInWithEmailAndPassword(email, password)
      .then(result => {
        const user = result.user;

        if (!user.emailVerified) {
          alert("ì´ë©”ì¼ ì¸ì¦ í›„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¤í¨ ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
          auth.signOut();
          return;
        }

        alert("ë¡œê·¸ì¸ ì„±ê³µ!");
        location.href = "index.html";
      })
      .catch(err => {
        alert("ë¡œê·¸ì¸ ì˜¤ë¥˜: " + err.message);
      });
  };

  // âœ… Google ë¡œê·¸ì¸
  document.getElementById("googleLogin").onclick = function () {
    const provider = new firebase.auth.GoogleAuthProvider();

    auth.signInWithPopup(provider)
      .then(() => {
        alert("Google ë¡œê·¸ì¸ ì„±ê³µ!");
        location.href = "index.html";
      })
      .catch(err => alert("ì˜¤ë¥˜: " + err.message));
  };

  // âœ… ìƒë‹¨ ë©”ë‰´ ë¡œê·¸ì¸ ìƒíƒœ ë°˜ì˜
  auth.onAuthStateChanged(user => {
    const loginMenu = document.getElementById("loginMenu");
    const userMenu = document.getElementById("userMenu");
    const userName = document.getElementById("userName");

    if (!loginMenu || !userMenu) return;

    if (user) {
      loginMenu.style.display = "none";
      userMenu.style.display = "inline";
      const name = user.displayName || user.email;
      userName.textContent = `[${name}]`;
    } else {
      loginMenu.style.display = "inline";
      userMenu.style.display = "none";
    }
  });

  // âœ… ë¡œê·¸ì•„ì›ƒ
  document.addEventListener("click", e => {
    if (e.target.id === "logoutBtn") {
      e.preventDefault();
      auth.signOut().then(() => {
        alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
        location.href = "index.html";
      });
    }
  });
</script>

</body>
</html>








